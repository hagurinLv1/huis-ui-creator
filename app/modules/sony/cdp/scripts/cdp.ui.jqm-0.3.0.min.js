/*!
 * cdp.ui.jqm.js 0.3.0
 *
 * Date: 2015-08-26T14:28:55
 */
!function(a,b){"function"==typeof define&&define.amd?define(["cdp.framework.jqm","cdp.tools","cdp.ui.listview"],function(){return b(a.CDP||(a.CDP={}))}):b(a.CDP||(a.CDP={}))}(this,function(a){a.UI=a.UI||{};var a;!function(a){var b;!function(a){var b,c="[CDP.UI.Toast] ";!function(a){function b(b,g,h){void 0===g&&(g=a.LENGTH_SHORT);var i=$.mobile,j=h||new f,k=j.getStyle()?!0:!1,l=b.replace(/\n/g,"<br/>"),m="<div>"+l+"</div>",n=$(m).addClass(j.getClass());k&&n.css(j.getStyle()),n.css({top:0,left:0}).appendTo(i.pageContainer);var o,p,q=j.getOffsetPoint(),r=$(window),s=n.width()+parseInt(n.css("padding-left"),10)+parseInt(n.css("padding-right"),10),t=n.height()+parseInt(n.css("padding-top"),10)+parseInt(n.css("padding-bottom"),10);switch(15&q){case d.LEFT:o=0+j.getOffsetX();break;case d.RIGHT:o=r.width()-s+j.getOffsetX();break;case d.CENTER:o=r.width()/2-s/2+j.getOffsetX();break;default:console.warn(c+"warn. unknown offsetPoint:"+(15&q)),o=r.width()/2-s/2+j.getOffsetX()}switch(240&q){case e.TOP:p=0+j.getOffsetY();break;case e.BOTTOM:p=r.height()-t+j.getOffsetY();break;case e.CENTER:p=r.height()/2-t/2+j.getOffsetY();break;default:console.warn(c+"warn. unknown offsetPoint:"+(240&q)),p=r.height()/2-t/2+j.getOffsetY()}n.css({top:p,left:o}).delay(g).fadeOut(400,function(){$(this).remove()})}a.LENGTH_SHORT=1500,a.LENGTH_LONG=4e3,function(a){a[a.LEFT=1]="LEFT",a[a.RIGHT=2]="RIGHT",a[a.CENTER=4]="CENTER"}(a.OffsetX||(a.OffsetX={}));var d=a.OffsetX;!function(a){a[a.TOP=16]="TOP",a[a.BOTTOM=32]="BOTTOM",a[a.CENTER=64]="CENTER"}(a.OffsetY||(a.OffsetY={}));var e=a.OffsetY,f=function(){function a(){}return a.prototype.getClass=function(){return"ui-loader ui-overlay-shadow ui-corner-all ui-body-b"},a.prototype.getStyle=function(){var a={padding:"7px 25px 7px 25px",display:"block",opacity:.8};return a},a.prototype.getOffsetPoint=function(){return d.CENTER|e.BOTTOM},a.prototype.getOffsetX=function(){return 0},a.prototype.getOffsetY=function(){return-75},a}();a.StyleBuilderDefault=f,a.show=b}(b=a.Toast||(a.Toast={}))}(b=a.UI||(a.UI={}))}(a||(a={}));var a;!function(a){var b;!function(b){var c=a.Framework,d="[CDP.UI.Dialog] ",e=function(){function b(c,d){this._template=null,this._settings=null,this._$dialog=null,b.initCommonCondition(),this._settings=$.extend({},b.s_defaultOptions,d),this._template=a.Tools.Template.getJST(c,this._settings.src)}return b.prototype.show=function(a){var c=this,d=$(document),e=$("body"),f=e.pagecontainer("getActivePage"),g="touchmove mousemove MSPointerMove",h=function(a){a.preventDefault()},i={overflow:"hidden","overflow-x":"hidden","overflow-y":"hidden"},j={overflow:e.css("overflow"),"overflow-x":e.css("overflow-x"),"overflow-y":e.css("overflow-y")},k={overflow:f.css("overflow"),"overflow-x":f.css("overflow-x"),"overflow-y":f.css("overflow-y")};return null!=a&&(this._settings=$.extend({},this._settings,a)),this._settings._header=this._settings.title?"has-title":"no-title",this._$dialog=$(this._template(this._settings)),e.append(this._$dialog),this._$dialog.popup({dismissible:this._settings.dismissible,transition:this._settings.transition,positionTo:"window",create:function(a,j){d.on(g,h),e.css(i),f.css(i),b.register(c)},afterclose:function(a,i){f.css(k),e.css(j),d.off(g,h),b.register(null),c._$dialog.remove(),c._$dialog=null}}).popup("open").on(this._settings.event,function(a){a.preventDefault(),"false"!==$(a.target).attr("data-auto-close")&&c.close()}),this._$dialog},b.prototype.close=function(){this._$dialog&&this._$dialog.popup("close")},Object.defineProperty(b.prototype,"$el",{get:function(){return this._$dialog},enumerable:!0,configurable:!0}),b.setDefaultOptions=function(a){b.initCommonCondition(),$.extend(!0,b.s_defaultOptions,a)},b.register=function(a){null!=a&&null!=b.s_activeDialog&&console.warn(d+"new dialog proc is called in the past dialog's one. use setTimeout() for post process."),b.s_activeDialog=a},b.initCommonCondition=function(){return c.isInitialized()?void(null==b.s_oldBackKeyHandler&&(b.s_oldBackKeyHandler=a.setBackButtonHandler(null),a.setBackButtonHandler(b.customBackKeyHandler),b.s_defaultOptions={idPositive:"dlg-btn-positive",idNegative:"dlg-btn-negative",event:c.getDefaultClickEvent(),dismissible:!1,transition:"pop",labelPositive:"OK",labelNegative:"Cancel"})):void console.warn(d+"initCommonCondition() should be called after Framework.initialized.")},b.customBackKeyHandler=function(a){var c;return null!=b.s_activeDialog?void(null!=b.s_activeDialog._settings.idNegative&&(c=b.s_activeDialog._$dialog.find("#"+b.s_activeDialog._settings.idNegative),0===c.length&&(c=b.s_activeDialog._$dialog),c.trigger(b.s_activeDialog._settings.event))):void b.s_oldBackKeyHandler(a)},b.s_activeDialog=null,b.s_oldBackKeyHandler=null,b.s_defaultOptions=null,b}();b.Dialog=e}(b=a.UI||(a.UI={}))}(a||(a={}));var a,b=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};!function(a){var c;!function(c){var d=a.Framework,e=function(a){function c(b){if(a.call(this,b),this._owner=null,this._owner=b.owner,b.$el){var c=this.events?!0:!1;this.setElement(b.$el,c)}}return b(c,a),Object.defineProperty(c.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),c}(Backbone.View);c.PageContainerView=e;var f=function(a){function e(b,e,f){a.call(this,f),this._pageOptions=null,this._basePage=null,this._statusMgr=null,this._pageOptions=$.extend({},{owner:this},f),this._basePage=this._pageOptions.basePage?new this._pageOptions.basePage(b,e,this._pageOptions):new d.Page(b,e,this._pageOptions),this._statusMgr=new c.StatusManager;var g=this.events?!0:!1;this.setElement(this.$page,g)}return b(e,a),e.prototype.statusAddRef=function(a){return this._statusMgr.statusAddRef(a)},e.prototype.statusRelease=function(a){return this._statusMgr.statusRelease(a)},e.prototype.statusScope=function(a,b){this._statusMgr.statusScope(a,b)},e.prototype.isStatusIn=function(a){return this._statusMgr.isStatusIn(a)},Object.defineProperty(e.prototype,"active",{get:function(){return this._basePage.active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._basePage.url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._basePage?this._basePage.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$page",{get:function(){return this._basePage.$page},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$header",{get:function(){return this._basePage.$header},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$footer",{get:function(){return this._basePage.$footer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"intent",{get:function(){return this._basePage.intent},set:function(a){this._basePage.intent=a},enumerable:!0,configurable:!0}),e.prototype.onOrientationChanged=function(a){},e.prototype.onHardwareBackButton=function(a){return!1},e.prototype.onBeforeRouteChange=function(){return $.Deferred().resolve().promise()},e.prototype.onCommand=function(a,b){},e.prototype.onInitialize=function(a){},e.prototype.onPageBeforeCreate=function(a){this.setElement(this.$page,!0)},e.prototype.onPageInit=function(a){},e.prototype.onPageBeforeShow=function(a,b){},e.prototype.onPageShow=function(a,b){},e.prototype.onPageBeforeHide=function(a,b){},e.prototype.onPageHide=function(a,b){},e.prototype.onPageRemove=function(a){this.remove()},e}(Backbone.View);c.PageView=f}(c=a.UI||(a.UI={}))}(a||(a={}));var a;!function(a){var c;!function(a){var c=function(c){function d(b,d,e){c.call(this,b,d,$.extend({},{autoDestoryElement:!1},e)),this._scrollMgr=null,this._needRebuild=!1,this._scrollMgr=new a.ScrollManager(e)}return b(d,c),d.prototype.reserveRebuild=function(){this._needRebuild=!0},d.prototype.onOrientationChanged=function(a){this._scrollMgr.setBaseHeight(this.getPageBaseHeight())},d.prototype.onBeforeRouteChange=function(){return this._pageOptions.autoDestoryElement&&this._scrollMgr.destroy(),c.prototype.onBeforeRouteChange.call(this)},d.prototype.onPageBeforeShow=function(a,b){c.prototype.onPageBeforeShow.call(this,a,b),this._scrollMgr.initialize(this.$page,this.getPageBaseHeight())},d.prototype.onPageShow=function(a,b){c.prototype.onPageShow.call(this,a,b),this._scrollMgr.setBaseHeight(this.getPageBaseHeight()),this._needRebuild&&(this.rebuild(),this._needRebuild=!1)},d.prototype.onPageRemove=function(a){c.prototype.onPageRemove.call(this,a),this.release()},d.prototype.isInitialized=function(){return this._scrollMgr.isInitialized()},d.prototype.addItem=function(b,c,d,e){this._addLine(new a.LineProfile(this,Math.floor(b),c,d),e)},d.prototype._addLine=function(a,b){this._scrollMgr._addLine(a,b)},d.prototype.removeItem=function(a,b,c){this._scrollMgr.removeItem(a,b,c)},d.prototype.getItemInfo=function(a){return this._scrollMgr.getItemInfo(a)},d.prototype.refresh=function(){this._scrollMgr.refresh()},d.prototype.update=function(){this._scrollMgr.update()},d.prototype.rebuild=function(){this._scrollMgr.rebuild()},d.prototype.release=function(){this._scrollMgr.release()},d.prototype.backup=function(a){return this._scrollMgr.backup(a)},d.prototype.restore=function(a,b){void 0===b&&(b=!0);var c=this._scrollMgr.restore(a,b);return c&&!b&&this.reserveRebuild(),c},d.prototype.hasBackup=function(a){return this._scrollMgr.hasBackup(a)},d.prototype.clearBackup=function(a){return this._scrollMgr.clearBackup(a)},Object.defineProperty(d.prototype,"backupData",{get:function(){return this._scrollMgr.backupData},enumerable:!0,configurable:!0}),d.prototype.setScrollHandler=function(a,b){this._scrollMgr.setScrollHandler(a,b)},d.prototype.setScrollStopHandler=function(a,b){this._scrollMgr.setScrollStopHandler(a,b)},d.prototype.getScrollPos=function(){return this._scrollMgr.getScrollPos()},d.prototype.getScrollPosMax=function(){return this._scrollMgr.getScrollPosMax()},d.prototype.scrollTo=function(a,b,c){this._scrollMgr.scrollTo(a,b,c)},d.prototype.ensureVisible=function(a,b){this._scrollMgr.ensureVisible(a,b)},d.prototype.getScrollMapHeight=function(){return this._scrollMgr.getScrollMapHeight()},d.prototype.updateScrollMapHeight=function(a){this._scrollMgr.updateScrollMapHeight(a)},d.prototype.updateProfiles=function(a){this._scrollMgr.updateProfiles(a)},d.prototype.getScrollMapElement=function(){return this._scrollMgr.getScrollMapElement()},d.prototype.findRecycleElements=function(){return this._scrollMgr.findRecycleElements()},d.prototype.getListViewOptions=function(){return this._scrollMgr.getListViewOptions()},d.prototype.getPageBaseHeight=function(){return $(window).height()-parseInt(this.$page.css("padding-top"),10)},d}(a.PageView);a.PageListView=c}(c=a.UI||(a.UI={}))}(a||(a={}));var a;return function(a){var c;!function(a){var c=function(c){function d(b,d,e){c.call(this,b,d,e),this._expandManager=null,this._expandManager=new a.ExpandManager(this)}return b(d,c),d.prototype.newGroup=function(a){return this._expandManager.newGroup(a)},d.prototype.getGroup=function(a){return this._expandManager.getGroup(a)},d.prototype.registerTopGroup=function(a){this._expandManager.registerTopGroup(a)},d.prototype.getTopGroups=function(){return this._expandManager.getTopGroups()},d.prototype.expandAll=function(){this._expandManager.expandAll()},d.prototype.collapseAll=function(a){this._expandManager.collapseAll(a)},d.prototype.isExpanding=function(){return this._expandManager.isExpanding()},d.prototype.isCollapsing=function(){return this._expandManager.isCollapsing()},d.prototype.isSwitching=function(){return this._expandManager.isSwitching()},Object.defineProperty(d.prototype,"layoutKey",{get:function(){return this._expandManager.layoutKey},set:function(a){this._expandManager.layoutKey=a},enumerable:!0,configurable:!0}),d.prototype.release=function(){c.prototype.release.call(this),this._expandManager.release()},d.prototype.backup=function(a){return this._expandManager.backup(a)},d.prototype.restore=function(a,b){return void 0===b&&(b=!0),this._expandManager.restore(a,b)},d}(a.PageListView);a.PageExpandableListView=c}(c=a.UI||(a.UI={}))}(a||(a={})),a.UI});